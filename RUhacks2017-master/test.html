<!DOCTYPE html>
<html>

<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>

<body>

<h2>Convert a string written in JSON format, into a JavaScript object.</h2>

<p id="demo"></p>

<script>
var start = '{\"text\": \" '
var end = ' \"}'
var message = 'what a time to be alive sad sorrow';
var data = '';
var rating = '';

function yourFunction(callback){
  $.ajax({
      url: "https://watson-api-explorer.mybluemix.net/tone-analyzer/api/v3/tone?version=2016-05-19&text=",
      type: 'POST',
      dataType: 'json',
      contentType: 'application/json',
      processData: false,
      data: "" + start + message + end,
      success: function (data) {
      alert(JSON.stringify(data));
      //data = JSON.stringify(data.document_tone.tone_categories[0].tones[0].tone_id);
      },
      error: function(){
          alert("Cannot get data");
      }

      }).done(function(result) {
          /* do something with the result here */
          // alert("asdfdafasdf" + x);
          rating = JSON.stringify(result);
          document.write(rating);
          callback(result); // invokes the callback function passed as parameter
    });
}

yourFunction(function(result) {
    rating = (JSON.stringify(result.document_tone.tone_categories[0].tones[0].score));

    if(rating < 0.05){
    alert("That is offensive");
    }

});

/*var myJSON = '{"document_tone":{"tone_categories":[{"tones":[{"score":0.184516,"tone_id":"anger","tone_name":"Anger"},{"score":0.081514,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.330223,"tone_id":"fear","tone_name":"Fear"},{"score":0.002062,"tone_id":"joy","tone_name":"Joy"},{"score":0.540505,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]},"sentences_tone":[{"sentence_id":0,"text":"Hi Team, I know the times are difficult!","input_from":0,"input_to":40,"tone_categories":[{"tones":[{"score":0.183278,"tone_id":"anger","tone_name":"Anger"},{"score":0.185471,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.11467,"tone_id":"fear","tone_name":"Fear"},{"score":0.055231,"tone_id":"joy","tone_name":"Joy"},{"score":0.536097,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]},{"sentence_id":1,"text":"Our sales have been disappointing for the past three quarters for our data analytics product suite.","input_from":41,"input_to":140,"tone_categories":[{"tones":[{"score":0.217901,"tone_id":"anger","tone_name":"Anger"},{"score":0.085927,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.084496,"tone_id":"fear","tone_name":"Fear"},{"score":0.002387,"tone_id":"joy","tone_name":"Joy"},{"score":0.727287,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]},{"sentence_id":2,"text":"We have a competitive data analytics product suite in the industry.","input_from":141,"input_to":208,"tone_categories":[{"tones":[{"score":0.259924,"tone_id":"anger","tone_name":"Anger"},{"score":0.05971,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.11335,"tone_id":"fear","tone_name":"Fear"},{"score":0.066336,"tone_id":"joy","tone_name":"Joy"},{"score":0.545245,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]},{"sentence_id":3,"text":"But we need to do our job selling it!","input_from":209,"input_to":246,"tone_categories":[{"tones":[{"score":0.074863,"tone_id":"anger","tone_name":"Anger"},{"score":0.087448,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.777488,"tone_id":"fear","tone_name":"Fear"},{"score":0.010883,"tone_id":"joy","tone_name":"Joy"},{"score":0.141648,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]}]}{"document_tone":{"tone_categories":[{"tones":[{"score":0.084006,"tone_id":"anger","tone_name":"Anger"},{"score":0.007501,"tone_id":"disgust","tone_name":"Disgust"},{"score":0.087016,"tone_id":"fear","tone_name":"Fear"},{"score":0.49305,"tone_id":"joy","tone_name":"Joy"},{"score":0.173386,"tone_id":"sadness","tone_name":"Sadness"}],"category_id":"emotion_tone","category_name":"Emotion Tone"}]}}
'; */


var myObj = JSON.parse(data);
document.getElementById("demo").innerHTML = data;

</script>

</body>
</html>
